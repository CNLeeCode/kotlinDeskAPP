// 引入由 Gradle 插件生成的依赖列表
// 注意：如果你运行 ./gradlew writeConveyorConfig 失败，请参考下方的“手动路径”说明

app {
  // --- 1. 基础元数据 ---
  display-name = "PG Printer"
  fsname = "pgprinter"
  rdns-name = "com.pgprint.app"
  vendor = "BUTCOMPANY"
  description = "外卖订单打印助手"

  // 版本号建议同步 Gradle 定义
  version = 1.0.3

  // --- 2. 目标平台 (Conveyor 21 必须明确指定) ---
  // 既然你要打 Windows 版本，amd64 是最通用的 64 位架构
  machines = [ windows.amd64 ]

  // --- 3. JVM 配置 ---
  jvm {
    gui.main-class = "com.pgprint.app.MainKt"
    inputs = [
      // 1. 你的主程序 JAR
      "composeApp/build/libs/*.jar"

      // 2. 你的所有第三方依赖 (Compose 插件会把依赖收集到这里)
      "composeApp/build/compose/tmp/prepareAppResources/libs/*.jar"
    ]
    // 强制 UTF-8，彻底解决 Windows 乱码
    system-properties {
      file.encoding = "UTF-8"
      sun.jnu.encoding = "UTF-8"
      apple.awt.UIElement = "true"
    }

    // 自动提取 JAR 里的 native 库 (解决 SqlDelight/SQLite 报错的关键)
    extract-native-libraries = true

    // 限制内存，防止 Java 进程占用过多内存
    options = ["-Xmx1g"]
  }

  // --- 4. Windows 专属配置 ---
  windows {
    // 建议固定此 UUID，用于版本升级覆盖
    uuid = "550e8400-e29b-41d4-a716-446655440000"

    // 开启控制台窗口（调试时很有用，发版前可改为 false）
    console = true

    // 快捷方式与菜单
    menu-group = "PG Printer"
    shortcut-snapping = true
  }

  // --- 5. 更新与站点 ---
  // Conveyor 21 默认强制检查更新地址。如果不打算立即配置服务器，请设为 none
  #updates = none
  // 如果以后要开启自动更新，取消下面这行的注释
  //# site.base-url = "https://your-domain.com/downloads"

  // --- 6. 图标 ---
  // 放入一张 1024x1024 的 PNG，Conveyor 会自动处理图标转换
  #icons = "icons/icon.png"
}
conveyor.compatibility-level = 21
